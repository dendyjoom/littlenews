// filters:  isGet('cost', '[BID]') && isGet('cost', '0') && isGet('cost', '[PRICE]'),

var tzrsAll = [
  {
    enable: true,
    filters: true,
    link: 'https://loopmario.xyz/cr7fgP',
    list: [
      {
        id: 1,
        img: 'keto1.jpg',
        text: 'Быстро сбросить вес можно. 1 раз в день натощак выпить 2 та...',
      },
      {
        id: 2,
        img: 'keto2.jpg',
        text: 'Отличница из <span class="geo" data-type="city" data-dic="from">Москвы</span> изобрела простой способ похудения. 1 раз в день нужно...',
      },
      {
        id: 3,
        img: 'keto3.jpg',
        text: 'Живот и лицо сами начнут худеть. А поможет в этом аптечный ш...',
      },
      {
        id: 4,
        img: 'keto4.jpg',
        text: 'Потеряла вес, но не мужа. Рецепт: чайная ложка соды + чеснок и...',
      },
      {
        id: 5,
        img: 'keto5.jpg',
        text: 'Жир сам будет уходить! Просто выпей...',
      },
      {
        id: 6,
        img: 'keto6.jpg',
        text: 'Возрастной жир уйдет за 7 дней, нужно натощак...',
      },
      {
        id: 7,
        img: 'keto7.jpg',
        text: 'Худеем за неделю без диет. Просто пьем чайн...',
      },
      {
        id: 8,
        img: 'keto8.jpg',
        text: 'Малышева: для быстрого похудения - неделю пить...',
      },
      {
        id: 9,
        img: 'keto9.jpg',
        text: 'Мясников: не бойтесь! Это избавит от возрастного жира за неделю! Нужно...',
      },
      {
        id: 10,
        img: 'keto10.jpg',
        text: 'Минздрав открыл уникальный способ сброса веса. Обычная аптечная рома...',
      },
    ]
  },
  {
    enable: true,
    filters: isGet('cost', '[BID]') && isGet('cost', '0') && isGet('cost', '[PRICE]'),
    link: 'https://loopmario.xyz/yfb6cL',
    list: [
      {
        id: 11,
        img: 'parazit1.jpg',
        text: 'В <span class="geo" data-type="city" data-dic="in">Москве</span> ЭПИДЕМИЯ! Огромную опасность представляет новый вид...'
      },
      {
        id: 12,
        img: 'parazit2.jpg',
        text: 'Жук-убийца в <span class="geo" data-type="region" data-dic="in">Московской области</span>. Срочно нужно выпить чайну...'
      },
      {
        id: 13,
        img: 'parazit3.jpg',
        text: 'Мужчина в <span class="geo" data-type="city" data-dic="in">Москве</span> попал в кому из-за эпидемии. Он просто поел в...'
      },
      {
        id: 14,
        img: 'parazit4.jpg',
        text: 'Опасный паразит в <span class="geo" data-type="region" data-dic="in">Московской области</span> обитает в канализации по ул...'
      },
      {
        id: 15,
        img: 'parazit5.jpg',
        text: 'Женщину из <span class="geo" data-type="city" data-dic="from">Москвы</span> забрали на скорой. Вот что в ней нашли после употребления...'
      },
      {
        id: 16,
        img: 'parazit6.jpg',
        text: 'В <span class="geo" data-type="city" data-dic="in">Москве</span> обнаружен паразит общепита. Он обитает в овощах из магазина пя...'
      },
      {
        id: 17,
        img: 'parazit7.jpg',
        text: 'В <span class="geo" data-type="city" data-dic="in">Москве</span> из обычного прыща у мужчины начал лезть...'
      },
      {
        id: 18,
        img: 'parazit8.jpg',
        text: 'От паразитов в организме поможет сода. Рецепт: чайная ложка...'
      },
      {
        id: 19,
        img: 'parazit9.jpg',
        text: 'Медики в шоке что они нашли! Мужчина из <span class="geo" data-type="city" data-dic="from">Москвы</span> покупал продукты в магазине:...'
      },
      {
        id: 20,
        img: 'parazit10.jpg',
        text: 'Забытый метод избавиться от паразитов. Секрет КГБ: взять мазь зв...'
      },
      {
        id: 21,
        img: 'parazit11.jpg',
        text: 'В <span class="geo" data-type="city" data-dic="in">Москве</span> в обычном банане из магазина обнаружили ки...'
      }
    ]
  },
  {
    enable: true,
    filters: true,
    link: 'https://loopmario.xyz/Zgvxzk',
    list: [
      {
        id: 22,
        img: 'molodost1.jpg',
        text: 'Избавиться от возрастных морщин можно! Нужно намазать место лыж...'
      },
      {
        id: 23,
        img: 'molodost2.jpg',
        text: 'Мясников: от морщин в возрасте используйте копеечную аптечную мазь...'
      },
      {
        id: 24,
        img: 'molodost3.jpg',
        text: 'Отличница из <span class="geo" data-type="city" data-dic="from">Москвы</span> изобрела эликсир молодости: чеснок смешать с...'
      },
      {
        id: 25,
        img: 'molodost4.jpg',
        text: 'Ученые из СССР знали эликсир молодости! Забытое секретное свойство обычной кас...'
      },
      {
        id: 26,
        img: 'molodost5.jpg',
        text: 'Чтобы омолодить кожу лица, положите под язык советскую к...'
      },
      {
        id: 27,
        img: 'molodost6.jpg',
        text: 'Рецепт молодости. Записывайте рецепт: растворить 1 чайную ложку ку...'
      },
      {
        id: 28,
        img: 'molodost7.jpg',
        text: 'Минус 10 лет Вашей коже! Забытый секрет моделей СССР. Взять аптечный го...'
      },
      {
        id: 29,
        img: 'molodost8.jpg',
        text: 'Секрет молодости КГБ: чеснок + горчичник смешать с...'
      },
      {
        id: 30,
        img: 'molodost9.jpg',
        text: 'Пластический хирург из <span class="geo" data-type="region" data-dic="from">Московской области</span> показал как омолодить кожу! Нужно...'
      },
      {
        id: 31,
        img: 'molodost10.jpg',
        text: 'Появились морщины? Записывайте рецепт: 1 чайна ложка...'
      }
    ]
  },

  {
    enable: true,
    filters: true,
    link: 'https://loopmario.xyz/4c4Kqt',
    list: [
      {
        id: 32,
        img: 'sirodel1.jpg',
        text: 'Многодетная мать из <span class="geo" data-type="city" data-dic="from">Москвы</span> заработала 2 миллиона на обычном домашнем сы...'
      },
      {
        id: 33,
        img: 'sirodel2.jpg',
        text: 'Домашний сыр дома за 1 ночь. Рецепт: стакан молока смешать с...'
      },
      {
        id: 34,
        img: 'sirodel3.jpg',
        text: 'Домашний пармезан. Очень простой рецепт: 1 пакетик твердого...'
      },
      {
        id: 35,
        img: 'sirodel4.jpg',
        text: '<span class="geo" data-type="regiron">Московская область</span> шокирована тем, что делает эта девушка с сыром! Она берет...'
      },
      {
        id: 36,
        img: 'sirodel5.jpg',
        text: 'Домашний сыр с зеленью. Записывайте рецепт: 3 веточки петрушки...'
      },
      {
        id: 37,
        img: 'sirodel6.jpg',
        text: 'Сырные деньги. Она уже год поставляет домашний сыр в магазин пя...'
      },
      {
        id: 38,
        img: 'sirodel7.jpg',
        text: 'Специальный репортаж: у нее не было ничего! Она просто начала зарабатывать на с...'
      },
      {
        id: 39,
        img: 'sirodel8.jpg',
        text: 'Девочка из <span class="geo" data-type="city" data-dic="from">Москвы</span> изобрела уникальный рецепт домашнего сыра: ложка де...'
      },
      {
        id: 40,
        img: 'sirodel9.jpg',
        text: 'Гений из школы №12 г. <span class="geo" data-type="city">Москва</span> изобрел идеальный рецепт домашнего сыра. Он...'
      },
      {
        id: 41,
        img: 'sirodel10.jpg',
        text: 'Домашний сыр как хобби. Чтобы заработать миллион на продаже домашнего сыра нужно...'
      },
    ]
  },

  {
    enable: true,
    filters: true,
    link: 'https://loopmario.xyz/KpBWvM',
    list: [
      {
        id: 42,
        img: 'klubnika1.jpg',
        text: 'Многодетная мать из Москвы сделала миллион на...'
      },
      {
        id: 43,
        img: 'klubnika2.jpg',
        text: 'Девочка из <span class="geo" data-type="city" data-dic="from">Москвы</span> заработала за месяц на квартиру с помощью...'
      },
      {
        id: 44,
        img: 'klubnika3.jpg',
        text: 'Отличница из <span class="geo" data-type="city" data-dic="from">Москвы</span> отдала кредит за родителей. Миллионы уже заработаны с помощью...'
      },
      {
        id: 45,
        img: 'klubnika4.jpg',
        text: 'Бабушку из <span class="geo" data-type="city" data-dic="from">Москвы</span> оштрафовали за производство клубники в особо крупном...'
      },
      {
        id: 46,
        img: 'klubnika5.jpg',
        text: 'Женщина из <span class="geo" data-type="city" data-dic="from">Москвы</span> стала первым клубничным миллионером, а помог ей...'
      },
      {
        id: 47,
        img: 'klubnika6.jpg',
        text: 'Клубника дома за неделю. Рецепт: семена замочить в...'
      },
      {
        id: 48,
        img: 'klubnika7.jpg',
        text: 'Миллионеры из <span class="geo" data-type="city" data-dic="from">Москвы</span>. Месяц назад у них не было ничего, а сейчас...'
      },
      {
        id: 49,
        img: 'klubnika8.jpg',
        text: 'Гений из <span class="geo" data-type="city" data-dic="from">Москвы</span>. Свой первый миллион я заработал в школе на обычной к...'
      },
      {
        id: 50,
        img: 'klubnika9.jpg',
        text: 'Отборная клубника в домашних условиях зимой? Легко! Нужно...'
      },
      {
        id: 51,
        img: 'klubnika10.jpg',
        text: 'Ягодное золото. Какие штрафы готовят тем, кто выращивает клубнику дома?'
      },
    ]
  },
];

// Дальше ничего не трогать

var tzrsUser = [];
for (category in tzrsAll) {
  if(tzrsAll[category].filters && tzrsAll[category].enable){
    var tmpTzrs = tzrsAll[category].list;
    for(tzr in tmpTzrs){
      tmpTzrs[tzr]['link'] = tzrsAll[category].link;
    }
    tzrsUser = tzrsUser.concat(tmpTzrs)
  }
}

// Клоака
function isGet(p, v){
  if(getQuery(p) == v){
    return true;
  }else{
    return false;
  }
}

function getQuery(q) {
   return (window.location.search.match(new RegExp('[?&]' + q + '=([^&]+)')) || [, null])[1];
}

function geoSet(selector){
  ymaps.ready(function(){
    var geolocation = ymaps.geolocation;

    $(selector).find('.geo').each(function(){
      var dic = $(this).data('dic');
      var type = $(this).data('type');

      if(type == 'contry'){
        var result = geolocation.country;
      }else if(type == 'region'){
        var result = geolocation.region.replace('Москва и Московская область', 'Московская область');
      }else if(type == 'city'){
        var result = geolocation.city;
      }

      if(dic == 'in'){
        var result = lvovich.cityIn(result);
      }else if(dic == 'from'){
        var result = lvovich.cityFrom(result);
      }else if(dic == 'to'){
        var result = lvovich.cityTo(result);
      }
      $(this).text(result);
    });
  });
}

function appendTzr(selector){
  var tzr = tzrsUser[Math.floor(Math.random()*tzrsUser.length)];
  $(selector).append('<a href="' + tzr.link + '?sub_id_2=' + tzr.id + location.search.replace('?', '&') + '"><img src="media/files/' + tzr.img + '"><p>' + tzr.text + '</p></a>');
}

$(function(){
  $('.tzr').each(function(){
    appendTzr($(this));
  });
  geoSet('body');
});

$(window).scroll(function() {
  if($(window).scrollTop() + $(window).height() > $(document).height() - 300) {
    $('.ajax-posts').append('<div class="row ajax-load"><div class="row"><div class="col-md-12"><div class="row line-posts"><div class="col-md-6"><div class="tzr line"></div></div><div class="col-md-6"><div class="tzr line"></div></div></div></div></div><div class="col-md-3"><div class="tzr cube"></div></div><div class="col-md-3"><div class="tzr cube"></div></div><div class="col-md-3"><div class="tzr cube"></div></div><div class="col-md-3"><div class="tzr cube"></div></div><div class="row"><div class="col-md-12"><div class="row line-posts"><div class="col-md-6"><div class="tzr line"></div></div><div class="col-md-6"><div class="tzr line"></div></div></div></div></div><div class="col-md-3"><div class="tzr cube"></div></div><div class="col-md-3"><div class="tzr cube"></div></div><div class="col-md-3"><div class="tzr cube"></div></div><div class="col-md-3"><div class="tzr cube"></div></div></div>');
      $('.ajax-posts .ajax-load:last-child .tzr').each(function(){
        appendTzr($(this));
      });
      geoSet('.ajax-posts .ajax-load:last-child');
    
  }
});